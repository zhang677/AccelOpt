test_name: matmul_add_rmsnorm

parameters:
- M
- N
- K

input: |
  x = np.random.normal(loc=0, scale=1.0, size=(M, K)).astype(np.float32)
  w = np.random.normal(loc=0, scale=1.0, size=(K, N)).astype(np.float32)
  eps = 1e-5
  z = np.random.normal(loc=0, scale=1.0, size=(M, N)).astype(np.float32)
  g = np.random.normal(loc=0, scale=1.0, size=(N,)).astype(np.float32)
  return [x, w, eps, z, g]

impl: |
  def forward(x, w, eps, z, g):
    y = np.matmul(x, w) + z
    rms = np.sqrt(np.mean(y ** 2, axis=-1, keepdims=True) + eps)
    return y * g / rms